## form.js

Този файл отговаря за логиката, свързана с формата за потвърждение на присъствие.
Тук се обработва submit събитието, взимат се данните от формата,
записва се информацията за гостите в базата
и се финализира резервирането на избраните подаръци.
Файлът служи като връзка между UI, Firestore и бизнес логиката.

Импортира се функцията `getGifts`, глобалният масив `gifts`
и функцията `toggleGift` от `gifts.js`.
Те се използват за работа с подаръците и за обновяване на визуалното им състояние.

Импортират се функциите `addGuestToDB` и `reserveGiftInDB` от `firebase.js`,
които отговарят за записите в Firestore.
По този начин логиката за базата остава отделена от UI логиката.

Импортира се `render` от `lit-html`,
който се използва за повторно рендериране на списъка с подаръци след промени.

Импортира се `giftsTemplate` от `templates.js`,
който дефинира HTML структурата на подаръците.

Импортира се функцията `showMessage` от `utils.js`,
която показва визуални съобщения към потребителя
вместо стандартни browser alert-и.

Функцията `getGuestData` извлича въведените данни от формата.
Тя намира формата по ID `attendence-form`,
взима стойността на полето за име и полето за брой деца,
почиства ги от излишни интервали
и връща обект с информация за госта.

Функцията `attendenceFormSubmit` закача submit listener към формата.
При изпращане на формата се спира стандартното поведение на браузъра,
за да не се презарежда страницата.

Първо се извличат данните за госта чрез `getGuestData`.
Ако името липсва, се показва съобщение за грешка
и изпълнението на функцията се прекратява.

След това се взима стойността от select полето,
която указва дали гостът ще присъства.

Данните за госта се записват в Firestore чрез `addGuestToDB`.

След това се филтрират всички подаръци,
които са маркирани като избрани от потребителя.

За всеки избран подарък се извиква `reserveGiftInDB`,
която го маркира като резервиран в базата данни
и записва името на госта.

Локалното състояние на подаръка се обновява,
за да отразява промените веднага в UI,
без да е необходимо повторно извличане от базата.

След всички промени списъкът с подаръци се рендерира отново,
за да се покаже актуалното състояние на бутоните.

Накрая се показва успешно съобщение,
което информира потребителя,
че потвърждението и резервациите са записани успешно.
